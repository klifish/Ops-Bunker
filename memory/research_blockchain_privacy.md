# 区块链隐私研究库 (Blockchain Privacy Reference)

为了更好地理解 L K 的博士研究（ZKP + MPC），我建立这个快速参考库。
这有助于我在安全分析时联想到"隐私泄露角度"。

## 📚 核心概念速查

### 1️⃣ 零知识证明 (Zero-Knowledge Proof, ZKP)

**定义：**
证明者 (Prover) 能说服验证者 (Verifier) 某个陈述是真的，**而不透露该陈述的内容本身**。

**三个关键属性：**
- **完整性 (Completeness)**: 陈述为真时，诚实证明者总能说服验证者
- **健全性 (Soundness)**: 陈述为假时，欺骗证明者只能以极低概率说服验证者
- **零知识性 (Zero-knowledge)**: 验证者只学到"陈述为真"，不学到任何其他信息

**现实应用：**
- 密码学认证（证明你知道密码，而无需暴露密码本身）
- 区块链隐私（Zcash 匿名交易）
- 可扩展性（zk-SNARK 压缩计算证明）

**安全分析角度：**
- ⚠️ 如果 ZKP 实现有缺陷，可能泄露"边信息" (side-channel)
- ⚠️ 交互式 ZKP 容易受重放攻击；非交互式 ZKP（zk-SNARK）需要可信设置

---

### 2️⃣ 多方计算 (Secure Multi-Party Computation, MPC)

**定义：**
多个参与者各自持有私密输入，共同计算某个函数，**最后只学到函数输出，不学到任何他人的私密输入**。

**两个主要威胁模型：**
1. **Honest-but-Curious (Semi-honest)**
   - 参与者遵守协议，但尝试从中间消息推断他人的输入
   - 更弱的假设，实现更高效
   - 例：秘密分享 (Secret Sharing) 协议

2. **Malicious**
   - 参与者可以任意偏离协议
   - 需要零知识证明来验证正确性
   - 计算开销更大

**现实应用：**
- 隐私数据分析（多家医院合作分析患者数据，而无需共享原始数据）
- 分布式机器学习（多个数据所有者训练模型，而无需共享训练数据）
- 隐私拍卖（多个投标者竞价，而无需暴露出价）

**安全分析角度：**
- ⚠️ **信息泄露**: 即使"只学到输出"，从输出本身也可能反推出部分输入（例：通过差分分析）
- ⚠️ **通信量分析**: 攻击者可能通过监听通信模式、计时来推断参与者的行为
- ⚠️ **单点故障**: 某个参与者离线或作弊，整个计算可能失败或产生错误结果

---

### 3️⃣ 隐私泄露风险点 (Privacy Leakage Vectors)

这些是在分析应用时要检查的关键点：

| 风险点 | 描述 | 例子 |
|--------|------|------|
| **边信息 (Side-channel)** | 通过非预期的通道推断信息 | 执行时间、功耗、缓存、错误信息 |
| **差分分析** | 对比不同输入的输出，推断差异 | 两个用户的查询结果差异暴露了某人的信息 |
| **通信分析** | 从通信量、频率、大小推断 | 交易大小、交易频率可能泄露 金额信息 |
| **关联分析** | 将多个看似无关的数据关联 | 地址+时间戳组合可能识别出用户 |
| **重放攻击** | 重复之前的消息进行攻击 | 重放证明以伪造交易 |
| **共谋攻击** | 多个参与者联合分析 | 两个诚实参与者共谋推断第三方信息 |

---

## 🎯 在 Hyatt 安全测试中的应用

当我们测试 Hyatt（会员系统、积分、隐私）时，可以考虑这些角度：

1. **会员数据隐私**
   - 能否从会员系统的响应时间推断某人是否是会员？
   - 能否通过差分分析（查询不同的邮箱）推断用户信息？

2. **积分/优惠券系统**
   - 积分交易历史是否被正确隐藏（即使是本人查询也不该暴露他人）？
   - 批量查询时，是否有通信量泄露（例：查询 100 个账户 vs 查询 1 个账户，响应大小明显不同）？

3. **支付/预订流程**
   - 预订成功/失败的区别是否通过响应时间暴露（Timing side-channel）？
   - 取消订单是否可被追踪（关联分析：IP + 时间戳 + 用户 ID）？

---

## 📖 推荐深入阅读

- **ZKP**: Zcash (https://z.cash/) — 真实应用案例
- **MPC**: SPDZ 协议 (https://eprint.iacr.org/) — 工业级实现
- **隐私**: OWASP Privacy Cheat Sheet

---

## 🛡️ 实战应用：隐私漏洞检测清单

在测试一个应用时，使用这份清单来识别隐私相关的漏洞：

### Web 应用隐私检测清单

**1. 账户枚举 (User Enumeration)**
```
- 能否通过"注册"/"密码重置"的响应差异识别是否存在某个用户？
- 登录失败的错误消息是否区分"用户不存在"和"密码错误"？
```

**2. 信息泄露 (Information Disclosure)**
```
- HTTP 响应头是否暴露了服务器、框架版本、云提供商？
- 错误消息是否包含敏感信息（文件路径、SQL 语句、内部 IP）？
- 源代码注释是否包含 API 端点或内部逻辑？
```

**3. 时序攻击 (Timing Attack)**
```
- 密码验证的响应时间是否与密码长度相关？
- 数据库查询的响应时间是否透露了行数或数据量？
```

**4. 关联分析 (Correlation Analysis)**
```
- 用户 ID、Session ID、Token 是否顺序递增（可被枚举）？
- 订单号/交易号是否可被关联（例：连续订单号暴露交易量）？
```

**5. 差分隐私缺陷 (Differential Privacy Failure)**
```
- 批量查询 vs 单个查询的响应大小/时间是否明显不同？
- 统计数据（"平均、总数"）是否可被反向工程推断个体数据？
```

### Hyatt 具体测试点

基于上述框架，对 Hyatt 的测试包括：

1. **会员系统 (world.hyatt.com)**
   - 能否通过"忘记密码"的邮件发送速度判断邮箱是否已注册？
   - 会员状态（普通/白金/钻石）是否可从响应头、Cookie、时序推断？

2. **支付流程**
   - 支付成功/失败的时间是否不同（可被用于 timing attack）？
   - 订单号是否顺序或可被枚举？

3. **积分兑换**
   - 积分余额查询的响应时间是否与余额大小相关？
   - 兑换历史是否可被用户 ID 枚举？

4. **位置隐私**
   - 酒店位置、房间类型、可用房间数是否被精确暴露？
   - 预订时间戳是否可被关联到特定用户的行为模式？

---

*这个库会随着 L K 的研究进展而更新。*
