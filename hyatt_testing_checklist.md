# Hyatt 手动狙击检查清单 (Manual Penetration Testing Checklist)

**目标**：深度逻辑测试（不是扫描），寻找 Bug Bounty 级别的漏洞  
**时间**：今晚 20:30 - 22:30（2 小时）  
**目标应用**：  
1. `world.hyatt.com` (会员系统) - **优先级 1**
2. `support.hyatt.com` (Support Portal) - **优先级 1**  
3. `meetings.hyatt.com` (会议预订) - **优先级 2**

---

## 📋 第一阶段：侦察与基线 (15 分钟)

### 1.1 被动信息收集
- [ ] 用 DevTools 查看请求/响应头（Server、X-Powered-By、缓存策略等）
- [ ] 记录所有 Cookie（名称、值、过期时间、Domain、Path、Secure、HttpOnly）
- [ ] 搜索源代码中的硬编码 API 端点、版本号、内部服务名
- [ ] 检查 `.js` 文件中的 API 调用（Network tab Filter by XHR）
- [ ] 记录所有 Form 字段名称和类型

### 1.2 认证机制分析
- [ ] 记录登录流程（POST 到哪里、返回什么）
- [ ] 检查 Session/Token 格式（JWT? 自定义? UUID?）
- [ ] 测试 Token 是否可被解码/解析
- [ ] 记录登出流程（清除 Cookie? 调用 API?）

---

## 🔐 第二阶段：认证 & 授权测试 (25 分钟)

### 2.1 账户枚举 (User Enumeration)
```
用户列表: admin@, test@, support@, vip@, gold@ + domain variations
```

- [ ] **忘记密码** → 对不同邮箱测试，记录响应差异
  - 存在账户的响应: ❌ / ✅ / 时间
  - 不存在账户的响应: ❌ / ✅ / 时间
  - **差异**: _______________

- [ ] **注册页面** → 尝试注册已存在/不存在的邮箱
  - 重复邮箱的错误消息是否暴露邮箱已存在？
  
- [ ] **登录页面** → "用户不存在" vs "密码错误" 的响应是否不同？

### 2.2 认证绕过
- [ ] **CSRF** → 无 CSRF Token / 可重用 Token / 弱校验?
- [ ] **Session 固定** → 登录前后 Session ID 是否改变？
- [ ] **Cookie 篡改** → 修改 `user_id`, `role`, `is_admin` 等字段，是否被接受？
- [ ] **JWT 攻击** (如果使用 JWT):
  - [ ] 能否删除签名部分（改成 `none` 算法）？
  - [ ] 能否修改 payload（改 `user_id` / `role`）？
- [ ] **暴力破解** → 登录是否有速率限制？

### 2.3 权限提升 (Privilege Escalation)
- [ ] 普通用户能否访问管理面板？ (`/admin`, `/dashboard`, `/api/admin/*`)
- [ ] 普通用户能否修改他人的个人信息？ (IDOR - Insecure Direct Object Reference)
  - 例：改 URL 中的 `user_id=123` 为 `user_id=456`
- [ ] 普通用户能否查看他人的订单/积分？
- [ ] 能否以他人身份执行操作？（横向权限提升）

---

## 💳 第三阶段：业务逻辑漏洞 (30 分钟)

### 3.1 会员系统 (world.hyatt.com)
- [ ] **积分系统**
  - [ ] 能否通过修改请求参数增加积分？（修改 `points`, `amount` 等）
  - [ ] 能否重复使用同一张优惠券？
  - [ ] 能否通过积分转账给他人？
  - [ ] 积分过期时间是否可被绕过？

- [ ] **会员升级/降级**
  - [ ] 能否直接改状态为 VIP / Platinum？
  - [ ] 升级条件是否可被绕过？（例：消费金额可被篡改）

- [ ] **个人信息修改**
  - [ ] 能否改他人的邮箱、电话、地址？
  - [ ] 能否改支付方式？

### 3.2 预订流程 (Booking Logic)
- [ ] **房间选择**
  - [ ] 能否预订已被预订的房间？
  - [ ] 能否修改价格？（修改 `price`, `rate` 参数）
  - [ ] 能否预订已关闭的日期？

- [ ] **支付**
  - [ ] 能否跳过支付直接完成预订？
  - [ ] 能否修改支付金额？
  - [ ] 能否使用他人的支付方式？

- [ ] **订单修改**
  - [ ] 订单确认后能否修改日期/房间？
  - [ ] 能否改他人的订单？

### 3.3 优惠券 & 折扣
- [ ] **优惠券滥用**
  - [ ] 能否重复使用单张优惠券？
  - [ ] 能否叠加多张优惠券？
  - [ ] 能否将优惠券值改大？
  - [ ] 优惠券是否可被他人使用？

---

## 🔒 第四阶段：隐私 & 信息泄露 (20 分钟)

### 4.1 数据暴露
- [ ] **API 响应** → 是否返回了不必要的敏感字段？
  - 例：返回他人的邮箱、电话、积分、订单历史？

- [ ] **错误消息** → 是否暴露了内部信息？
  - SQL 错误? 文件路径? 内部 IP? API 端点?

- [ ] **账户信息页** → 能否查看他人的账户信息？

### 4.2 时序攻击 (Timing Leaks)
- [ ] 登录失败的响应时间是否与密码长度相关？
- [ ] 数据库查询的响应时间是否暴露了行数？
- [ ] （高级）能否通过响应时间推断数据库中的敏感信息？

### 4.3 关联分析
- [ ] 订单号是否顺序递增？（可推断交易量）
- [ ] 用户 ID 是否顺序递增？（可枚举用户）
- [ ] Referer / User-Agent / IP 是否被记录？（可追踪用户行为）

---

## 🚨 第五阶段：深度逻辑 (20 分钟)

### 5.1 竞态条件 (Race Condition)
- [ ] 能否同时提交多个支付请求导致重复扣款？
- [ ] 能否在积分结算前修改账户数据？

### 5.2 参数污染
- [ ] API 是否接受多个同名参数？（例：`?user_id=1&user_id=2`）
- [ ] HTTP 头污染？（例：多个 `Cookie` / `Authorization`）

### 5.3 业务流程绕过
- [ ] 能否跳过某些步骤直接到达最终状态？
- [ ] 能否逆向业务流程？（例：已取消的订单能否恢复）

---

## 📊 第六阶段：API 深掘 (10 分钟)

如果发现了隐藏 API：
- [ ] 记录所有 API 端点 (`/api/v1/...`, `/graphql` 等)
- [ ] 测试常见的 API 漏洞：
  - [ ] API 是否有认证检查？
  - [ ] 是否存在 GraphQL 注入、IDOR?
  - [ ] 能否访问其他用户的资源？

---

## 📝 记录模板

### 漏洞记录
```
【标题】
【严重级别】Critical / High / Medium / Low
【类型】(IDOR / Logic Flaw / Auth Bypass / 等)
【描述】
【复现步骤】
1. 
2. 
3. 
【影响】
【截图/PoC】
```

---

## ✅ 完成检查表

- [ ] 所有测试步骤已执行
- [ ] 所有发现已记录
- [ ] 没有留下痕迹（清除 Cookies、History）
- [ ] 结果已整理成报告

---

**预计时间分配**：
- 侦察：15 分钟
- 认证：25 分钟
- 业务逻辑：30 分钟
- 隐私：20 分钟
- 深度逻辑：20 分钟
- API：10 分钟
- **缓冲 & 深掘**: 20 分钟

**总计**: ~2 小时

---

*准备好了就开始。Good luck! 🐾*
