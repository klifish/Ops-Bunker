# 实战案例库：Hyatt 测试 (2026-02-05)

## 📋 案例概述
- **目标**：Hyatt Hotels (*.hyatt.com)
- **日期**：2026-02-05 15:30 - 17:45
- **方法**：Web 安全测试 (黑盒)
- **结果**：无可利用漏洞，但发现了有价值的信息

---

## 🔍 第一个目标：support.hyatt.com

### 初期假设
- 支持门户（客户服务）
- 可能有 IDOR、权限提升等漏洞
- 高优先级目标

### 实际发现

**功能**：客户选择支持代表 → 下载远程访问应用 → 建立连接

**页面结构**：
- 语言选择下拉菜单
- 支持代表完整目录（30+ 人，ID 号从 15 到 313）
- 点击名字可下载客户端应用

**API 端点**：
```
GET/POST /download_client_connector?id=<id>&name=<name>
```

### 测试过程

| 测试 | 方法 | 结果 | 分析 |
|------|------|------|------|
| ID 枚举 | 修改 id=15 到 id=18 等 | 成功 | 所有 ID 都公开（设计如此） |
| 无效 ID | id=-1, id=0, id=999 | 拒绝或错误 | 系统有基本验证 |
| 参数验证 | 改错 name 值 | 404 Not Found | name 必须与 ID 匹配 |
| SQL 注入 | `name=Jonathan' OR '1'='1` | 拒绝 | 有输入过滤 |
| URL 编码注入 | `name=Jonathan%27%28%29...` | 404 | WAF 或应用层过滤 |
| GET vs POST | 同一参数，不同方法 | 返回不同 | POST 触发重定向 |

### 关键发现

✅ **无认证要求** — 任何人都可以访问

✅ **员工目录完全暴露** — 姓名 + ID 公开

✅ **参数验证在工作** — name 必须匹配 ID

⚠️ **有输入过滤** — 拦截了注入尝试

### 评估

**这是漏洞吗？NO**

**原因**：
- 这个系统**本来就是公开的**（让客户选择支持代表）
- 员工目录是故意暴露的（客户需要知道谁在帮他们）
- 防守措施在工作（验证和过滤）

**关键洞察**：
- 理解**业务目的**很重要
- 一个"看起来像漏洞"的东西，可能只是正常的设计
- 这节省了时间（不要浪费在明显无漏洞的系统上）

---

## 🔍 第二个目标：world.hyatt.com

### 初期状态
- 直接访问被 Akamai WAF 挡住 (HTTP 403)
- 假设无法测试

### 实际发现
- 用 Chrome 浏览器可以访问
- 这是真正的 **Hyatt Gold Passport** 会员系统
- 有登录入口、预订功能、积分系统

### 为什么浏览器能访问，curl 被挡？

**WAF 检测逻辑**：
- Chrome User-Agent → 识别为真实浏览器 → 允许
- curl User-Agent → 识别为机器人 → 阻止

**启示**：
- 有时候"404"不意味着目标不存在
- 可能只是工具选择错误
- 灵活切换工具（浏览器、curl、Burp 等）

---

## 📚 方法论总结

### 成功的做法
1. **快速侦察** — 用 curl 快速扫描，找到可访问目标
2. **灵活工具** — 一个工具不行就换另一个
3. **及时放弃** — 如果某个方向没收获，立即转向
4. **理解业务** — 知道系统为什么这样设计

### 失误的地方
1. **初始排序错误** — 基于猜测而非数据 (support 被高估)
2. **过度测试** — 在明显无漏洞的系统上花太多时间
3. **忽视工具限制** — curl 被挡但没立即改用浏览器

---

## 🎯 下一步方向

**优先级已修正**：
1. `world.hyatt.com` (会员系统) — 高价值
2. `goldpassport.hyatt.com` (积分系统) — 高价值
3. 其他需要认证的系统

**预期发现点**：
- 登录绕过
- IDOR (个人信息、订单、积分)
- 权限提升 (普通用户 → VIP)
- 业务逻辑漏洞 (积分转账、折扣叠加等)

---

## 💡 这次测试教会我的

1. **算法 ≠ 现实** — 决策引擎的初始排序被推翻了
2. **业务理解很关键** — support.hyatt.com 的"漏洞"实际上是特性
3. **灵活性很重要** — curl 失败，改用浏览器，问题解决
4. **时间是稀缺资源** — 及时放弃无收获的方向，专注高价值目标
